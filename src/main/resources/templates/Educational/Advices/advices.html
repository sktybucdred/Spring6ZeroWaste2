<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Advices</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <link rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link th:href="@{styles/main.css}" rel="stylesheet"/></head>
<body class="d-flex flex-column h-100">
<div th:replace="~{fragments/header :: header}"></div>

<div class="container">
    <h1 class="my-4">Advices</h1>

    <!-- Link to Create New Advice -->
    <a th:href="@{/advices/new}" class="btn btn-primary mb-3">Create New Advice</a>

    <!-- Filters -->
    <form method="get" th:action="@{/advices}" class="form-inline mb-3">
        <div class = "form-group mr-3">
            <label for="title" class="mr-2">Filter by Title:</label>
            <input type="text" name="title" id="title" class="form-control mr-2"
                   th:value="${title}" placeholder="Enter Title"/>
            <button type="submit" class="btn btn-secondary">Filter</button>
        </div>
    <!-- Filter by Category -->
    <form method="get" th:action="@{/advices}" class="form-inline mb-3">
        <label for="category" class="mr-2">Filter by Category:</label>
        <select name="category" id="category" class="form-control mr-2">
            <option value="" th:selected="${selectedCategory == null}">All</option>
            <option th:each="cat : ${categories}"
                    th:value="${cat}"
                    th:text="${cat}"
                    th:selected="${cat == selectedCategory}">
                Category
            </option>
        </select>
        <button type="submit" class="btn btn-secondary">Filter</button>
    </form>

    <!-- Advices List -->
    <div>
        <ul class="list-group">
            <li th:each="advice : ${advicePage.content}" class="list-group-item">
            <h5 th:text="${advice.title}">Advice Title</h5>
            <p th:text="${#strings.abbreviate(advice.content, 200)} + '...'">Advice Content</p>
            <a th:href="@{/advices/{id}(id=${advice.id})}" class="btn btn-link">Read More</a>
            <a th:href="@{/advices/edit/{id}(id=${advice.id})}" class="btn btn-secondary btn-sm">Edit</a>
            <a th:href="@{/advices/delete/{id}(id=${advice.id})}"
               class="btn btn-danger btn-sm"
               onclick="return confirm('Are you sure you want to delete this advice?');">Delete</a>
            </li>
        </ul>

        <!-- Pagination Controls -->
        <nav aria-label="Page navigation example" class="mt-4">
            <ul class="pagination">
                <li class="page-item" th:if="${advicePage.hasPrevious()}">
                    <a class="page-link" th:href="@{/advices(page=${advicePage.number - 1}, size=${advicePage.size}, category=${selectedCategory})}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                <li class="page-item" th:each="i : ${#numbers.sequence(0, advicePage.totalPages - 1)}"
                    th:classappend="${i == advicePage.number} ? ' active'">
                    <a class="page-link" th:href="@{/advices(page=${i}, size=${advicePage.size}, category=${selectedCategory})}" th:text="${i + 1}">1</a>
                </li>
                <li class="page-item" th:if="${advicePage.hasNext()}">
                    <a class="page-link" th:href="@{/advices(page=${advicePage.number + 1}, size=${advicePage.size}, category=${selectedCategory})}" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>
</body>
</html>